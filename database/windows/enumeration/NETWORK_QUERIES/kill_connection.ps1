# Script attemps to kill a connection with inputed address

try {
    # Prompt the user to input the remote address
    $RemoteAddress = Read-Host "Enter the remote address"

    # Retrieve TCP connection information with the specified remote address
    $TCPConnection = Get-NetTCPConnection -RemoteAddress $RemoteAddress -ErrorAction Stop

    if ($TCPConnection) {
        # Get the process ID associated with the TCP connection
        $ProcessID = $TCPConnection.OwningProcess

        if ($ProcessID) {
            # Get the process associated with the process ID
            $Process = Get-Process -Id $ProcessID -ErrorAction SilentlyContinue

            if ($Process) {
                # Stop the process associated with the process ID
                Stop-Process -Id $ProcessID -Force -Confirm:$false -ErrorAction Stop
            } else {
                Write-Host "No process found with the specified process ID." -ForegroundColor Yellow
            }
        } else {
            Write-Host "No process associated with the TCP connection." -ForegroundColor Yellow
        }
    } else {
        Write-Host "No TCP connection found with the specified remote address." -ForegroundColor Yellow
    }
} catch {
    Write-Host "An error occurred: $_" -ForegroundColor Red
}
