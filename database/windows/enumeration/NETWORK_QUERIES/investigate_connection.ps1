# Retrieves information about inputed connection

try {
    # Prompt the user to input the remote address
    $RemoteAddress = Read-Host "Enter the remote address"

    # Retrieve TCP connection information filtered by the user-provided remote address
    $TCPConnections = Get-NetTCPConnection -RemoteAddress $RemoteAddress |
                      Select-Object State, CreationTime, LocalPort, RemotePort |
                      Format-Table -AutoSize

    # Display the formatted TCP connection information
    Write-Output $TCPConnections
} catch {
    Write-Host "An error occurred: $_" -ForegroundColor Red
}
