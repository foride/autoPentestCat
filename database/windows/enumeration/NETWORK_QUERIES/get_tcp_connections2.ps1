# Captures all connections regardless of the application name

try {
    # Retrieve TCP connection information
    $TCPConnections = Get-NetTCPConnection |
                      Select-Object LocalAddress, LocalPort, RemoteAddress, RemotePort, State, 
                                    @{Name="Process"; Expression={(Get-Process -Id $_.OwningProcess).ProcessName}}, 
                                    @{Name="CmdLine"; Expression={(Get-WmiObject Win32_Process -Filter "ProcessId = $($_.OwningProcess)").CommandLine}}

    # Display the TCP connection information
    Write-Output $TCPConnections
} catch {
    Write-Host "An error occurred: $_" -ForegroundColor Red
}

