# Collect the DNS cache on an endpoint. Helpful for catching any sneaky communication or even DNS C2.

try {
    $DnsClientCache = Get-DnsClientCache | Out-String -Width 1000

    Write-Output $DnsClientCache
} catch {
    Write-Host "An error occurred: $_" -ForegroundColor Red
}
