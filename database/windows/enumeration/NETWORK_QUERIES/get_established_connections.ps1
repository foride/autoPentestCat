# Retrieves internet established connections, and sort by time established

try {
    # Retrieve TCP connection information with the "Internet" setting applied
    $TCPConnections = Get-NetTCPConnection -AppliedSetting Internet |
                      Select-Object RemoteAddress, RemotePort, CreationTime |
                      Sort-Object CreationTime |
                      Format-Table -AutoSize

    # Display the formatted TCP connection information
    Write-Output $TCPConnections
} catch {
    Write-Host "An error occurred: $_" -ForegroundColor Red
}