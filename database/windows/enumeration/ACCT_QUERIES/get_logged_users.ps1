# Retrieve currently logged-in users

try {
    $QuserOutput = quser 2>$null
    if ($QuserOutput) {
        Write-Host "Currently logged-in users (via quser):"
        $QuserOutput
    } else {
        try {
            # If quser fails, attempt to retrieve currently logged-in users using qwinsta
            $QwinstaOutput = qwinsta 2>$null
            if ($QwinstaOutput) {
                Write-Host "`nCurrently logged-in users (via qwinsta):"
                $QwinstaOutput
            } else {
                Write-Host "`nNo users found using qwinsta."
            }
        } catch {
            Write-Host "An error occurred while retrieving currently logged-in users using qwinsta: $_"
        }
    }
} catch {
    Write-Host "An error occurred while retrieving currently logged-in users using quser: $_"
}
