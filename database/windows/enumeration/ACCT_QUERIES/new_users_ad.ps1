# Retrieve AD users created in the last 7 days

try {
    Import-Module ActiveDirectory -ErrorAction Stop
    Write-Host "The Active Directory module has been imported successfully."

    $When = ((Get-Date).AddDays(-7)).Date

    $ADUsers = Get-ADUser -Filter {whenCreated -ge $When} -Properties whenCreated

    $SortedADUsers = $ADUsers | Sort-Object -Property whenCreated -Descending

    $SortedADUsers
} catch {
    Write-Host "An error occurred: $_"
}
