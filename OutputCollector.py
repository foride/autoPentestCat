from queue import Queue

class OutputCollector:
    def __init__(self):
        self.output_queue = Queue()

    def collect(self, command, stdout, stderr):
        self.output_queue.put((command, stdout, stderr))

    def display_outputs(self):
        while not self.output_queue.empty():
            command, stdout, stderr = self.output_queue.get()
            output_text = self.format_output(command, stdout, stderr)
            print(output_text)  # Print to console

    def write_outputs_to_file(self, filename):
        with open(filename, "a") as file:
            while not self.output_queue.empty():
                command, stdout, stderr = self.output_queue.get()
                output_text = self.format_output(command, stdout, stderr)
                file.write(output_text)  # Write to file

    def format_output(self, command, stdout, stderr):
        output_text = f"Output of '{command}':\n{stdout}"
        if stderr:
            error_text = "-" * 22 + "Error" + "-" * 23 + "\n" + stderr
            output_text += "\n" + error_text
        output_text += "\n" + "-" * 50 + "\n"
        return output_text

